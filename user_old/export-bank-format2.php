<?php error_reporting(0);session_start();include("../lib/connection/db-config.php");$setCounter = 0;$comp_id=$_SESSION['comp_id'];$user_id=$_SESSION['log_id'];$clintid=$_SESSION['clintid'];$setExcelName = "employee_detail"; $setSql= "SELECT e.emp_id as 'TICKETNO',e.first_name as 'FIRSTNAME',e.middle_name as 'MIDDLENAME',e.last_name as 'SURNAME',te.bankacno as 'BANKACNO',te.netsalary as 'NETSALARY',mb.bank_name as 'NETSALARY' FROM tran_employee te inner join employee e on e.emp_id = te.emp_id  inner JOIN mast_bank mb on te.bank_id = mb.mast_bank_id where te.client_id = '$clintid' ";  $setRec = mysql_query($setSql);$setCounter = mysql_num_fields($setRec);$setMainHeader="";$setData="";for ($i = 0; $i < $setCounter; $i++) {    $setMainHeader .= mysql_field_name($setRec, $i)."\t";}while($rec = mysql_fetch_row($setRec))  {    $rowLine = '';    foreach($rec as $value)       {        if(!isset($value) || $value == "")  {            $value = "\t";        }   else  {//It escape all the special charactor, quotes from the data.            $value = strip_tags(str_replace('"', '""', $value));            $value = '"' . $value . '"' . "\t";        }        $rowLine .= $value;    }    $setData .= trim($rowLine)."\n";}$setData = str_replace("\r", "", $setData);if ($setData == "") {    $setData = "\nno matching records found\n";}//This Header is used to make data download instead of display the dataheader("Content-type: application/octet-stream");header("Content-Disposition: attachment; filename=".$setExcelName.".xls");header("Pragma: no-cache");header("Expires: 0");//It will print all the Table row as Excel file row with selected column name as header.echo ucwords($setMainHeader)."\n".$setData."\n";?>